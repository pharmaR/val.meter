<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>riskmetric Comparison • val.meter</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="riskmetric Comparison">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">val.meter</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adding-metric.html">Adding a Metric</a></li>
    <li><a class="dropdown-item" href="../articles/internals-overview.html">Internals Overview</a></li>
    <li><a class="dropdown-item" href="../articles/repository-integrations.html">Repository Integrations</a></li>
    <li><a class="dropdown-item" href="../articles/riskmetric-comparison.html">riskmetric Comparison</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaR/val.meter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>riskmetric Comparison</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaR/val.meter/blob/main/vignettes/riskmetric-comparison.Rmd" class="external-link"><code>vignettes/riskmetric-comparison.Rmd</code></a></small>
      <div class="d-none name"><code>riskmetric-comparison.Rmd</code></div>
    </div>

    
    
<p><code>val.meter</code> is builds on years of experience from
<code>riskmetric</code> to arrive at a tool that is more robust, more
rigorous and more explicit. We’ve learned a lot by supporting
<code>riskmetric</code> - both ideas that we want to carry forward and
concepts that we plan to leave in the past.</p>
<div class="section level2">
<h2 id="design-philosophy">Design Philosophy<a class="anchor" aria-label="anchor" href="#design-philosophy"></a>
</h2>
<p>Fundamentally, the impetus for the change boils down to just a couple
core philosophies of <code>riskmetric</code> that manifested in an
unpleasant user experience.</p>
<div class="section level3">
<h3 id="precise-and-reproducible">Precise and reproducible<a class="anchor" aria-label="anchor" href="#precise-and-reproducible"></a>
</h3>
<p><code>riskmetric</code> was designed to be accommodating, but not
precise. When we launched development on <code>riskmetric</code>, our
primary intended audience was package <em>users</em>, who might need to
justify to a system administrator why they should have access to a R
package. These are analysts, statisticians and data scientists who may
not even have permission to install the package in order to make a case
for why it’s rigorously developed. For this reason, we tried to build
<code>riskmetric</code> to be accommodating to this use case, searching
for information wherever we could find it. Unfortunately, this came with
a sacrifice of reproducibility.</p>
<p>Some metrics could vary heavily depending on where you would gather
this information from.</p>
<p><code>val.meter</code> aims to address this by</p>
<ol style="list-style-type: decimal">
<li>Having far more rigorous default sources</li>
<li>Requiring that users opt-in to more variable metrics</li>
<li>Giving users tools to filter metrics by qualities of those metrics
(tags), for example, filtering out <em>transient</em> metrics - those
that should not be expected to be reproduced.</li>
</ol>
</div>
<div class="section level3">
<h3 id="unopinionated">Unopinionated<a class="anchor" aria-label="anchor" href="#unopinionated"></a>
</h3>
<p>When <code>riskmetric</code> launched, the idea of a unified
evaluation criteria was beyond our initial hopes for how the regulatory
R landscape could evolve. We built <code>riskmetric</code> under the
assumption that each regulatory sponsor would come with their own
existing expectations for software quality. We built
<code>riskmetric</code> with some naive defaults to demonstrate the
workflow, with the right hooks exposed to tailor the way metrics were
calculated.</p>
<p>What we found was that nearly everyone sticks with the defaults.
Taking the defaults as established guidance, organizations quickly
discovered that the conclusions drawn from trivial scoring mechanisms
leads to counterintuitive results.</p>
<p>Further, by trying to score packages, we embed opinions on how to
evaluate individual packages. For example, we transform lifetime
downloads - which can be any positive number - into a 0-to-1 scale. This
is non-trivial and may not map to the expectations across users. The
problem is compounded when users are expecting that a download count
score on a 0-to-1 scale reflects the risk of <code>R CMD check</code>
error counts mapped to a 0-to-1 scale. We never intended for this risk
scale to be completely consistently applied, nor was it intended to be
uncritically used for decision-making.</p>
<p>In <code>val.meter</code> we’re glad to announce that we have solved
this problem! By avoiding scores altogether, and instead focusing only
on concrete, unopinionated measures of packages, we hope to focus
discussions in <code>val.meter</code> on the calculation of these
metrics, not on their interpretation.</p>
<p>Don’t worry! We still plan to advocate for industry standards that
help wit the decision-making, but that work will live in a separate
package to allow folks with the most relevant expertise to focus on each
particular problem. We hope that this makes <code>val.meter</code> a
more welcoming environment for developers and that validation experts
and regulators can have more direct conversations about interpretation
when advocating for sensible defaults.</p>
</div>
</div>
<div class="section level2">
<h2 id="technical-details">Technical Details<a class="anchor" aria-label="anchor" href="#technical-details"></a>
</h2>
<div class="section level3">
<h3 id="assertive-package-discovery">Assertive package discovery<a class="anchor" aria-label="anchor" href="#assertive-package-discovery"></a>
</h3>
<p>First and foremost, <code>val.meter</code> is far more restrictive
about how package metrics are calculated by default. We still expose a
user-friendly interface to start the process with the <code><a href="../reference/pkg.html">pkg()</a></code>
function (similar to <code>riskmetric::pkg_ref()</code>) function, but
how it discovers potential sources of package information is controlled
by a <code><a href="../reference/policy.html">policy()</a></code>, which can be configured globally or as a
parameter.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmar.github.io/val.meter">val.meter</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pkg.html">pkg</a></span><span class="op">(</span><span class="st">"val.meter"</span><span class="op">)</span> <span class="co"># when installed locally</span></span>
<span><span class="co">#&gt; &lt;val.meter::pkg&gt;</span></span>
<span><span class="co">#&gt; @resource</span></span>
<span><span class="co">#&gt;   &lt;val.meter::install_resource&gt;</span></span>
<span><span class="co">#&gt;    @ package: chr NA</span></span>
<span><span class="co">#&gt;    @ version: chr NA</span></span>
<span><span class="co">#&gt;    @ id     : int 1</span></span>
<span><span class="co">#&gt;    @ md5    : chr NA</span></span>
<span><span class="co">#&gt;    @ path   : chr "/home/runner/work/_temp/Library/val.meter"</span></span>
<span><span class="co">#&gt; @permissions</span></span>
<span><span class="co">#&gt;   &lt;val.meter::permissions&gt; chr(0) </span></span>
<span><span class="co">#&gt; $vignette_count</span></span>
<span><span class="co">#&gt;   &lt;promise&gt;</span></span>
<span><span class="co">#&gt; $r_cmd_check_error_count</span></span>
<span><span class="co">#&gt;   &lt;promise&gt;</span></span>
<span><span class="co">#&gt; $downloads_total</span></span>
<span><span class="co">#&gt;   &lt;promise&gt;</span></span>
<span><span class="co">#&gt; $dependency_count</span></span>
<span><span class="co">#&gt;   &lt;promise&gt;</span></span>
<span><span class="co">#&gt; $has_website</span></span>
<span><span class="co">#&gt;   &lt;promise&gt;</span></span>
<span><span class="co">#&gt; $r_cmd_check (internal)</span></span>
<span><span class="co">#&gt; $desc (internal)</span></span>
<span><span class="co">#&gt; $archive_md5 (internal)</span></span>
<span><span class="co">#&gt; $name (internal)</span></span>
<span><span class="co">#&gt; $version (internal)</span></span></code></pre></div>
<p>Here we discover our local installation of <code>val.meter</code>,
but we would fail to discover it if it wasn’t installed, even for
packages available in your available repositories.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pkg.html">pkg</a></span><span class="op">(</span><span class="st">"val.meter"</span><span class="op">)</span> <span class="co"># when not installed</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error in convert(from, to, ...): Unable to discover package resource</span></span></code></pre>
<p>This default behavior may still evolve, but its intention is clear:
We want to be decisive about package sources and only permit high
quality reproducible sources by default.</p>
</div>
<div class="section level3">
<h3 id="assertive-behaviors">Assertive behaviors<a class="anchor" aria-label="anchor" href="#assertive-behaviors"></a>
</h3>
<p>Similarly, <em>how</em> packages are evaluated is controlled by
providing <code><a href="../reference/permissions.html">permissions()</a></code> to <code>val.meter</code> which
require users to opt-in to behaviors as they desire.</p>
<p>Permissions include behaviors like executing code, accessing
resources over the network and writing to your local filesystem. Each of
these permissions must be granted before metrics which require these
behaviors will be executed.</p>
<p>Similarly, some characteristics of metrics are not necessarily
sensitive, but may characterize metrics that you wish to include or
exclude. These characteristics are categorized as <code><a href="../reference/tags.html">tags()</a></code>.
For example, the number of package downloads are tagged as
<code>"transient"</code> and <code>"version-independent"</code> because
they will grow over time, even for the exact same package source, and
they are aggregated across package versions.</p>
<p>When exploring metrics, we’ll even see a little indicator that these
are enabled or disabled.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/metrics.html">metrics</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">downloads_total</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Total Downloads </span><span style="font-weight: 100;">&lt;integer&gt;</span></span></span>
<span><span class="co"><span style="font-style: italic;">#&gt; total number of lifetime downloads, as reported by the Posit CRAN mirror through the cranlogs API</span></span></span>
<span><span class="co">#&gt; <span style="color: #000000; background-color: #0000BB;"> adoption </span> <span style="color: #000000; background-color: #0000BB;"> transient </span> <span style="color: #000000; background-color: #0000BB;"> version-independent </span> <span style="color: #000000; background-color: #BB0000; font-weight: 100;"> req </span><span style="color: #000000; background-color: #FF5555;"> network </span></span></span>
<span><span class="co">#&gt; metric(s) will be disabled due to insufficient permissions or restricted tags.</span></span>
<span><span class="co">#&gt; See `?val.meter::options()` for details about global policies.</span></span></code></pre></div>
<p>And after permitting network access, we’ll see</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">permissive_policy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/policy.html">policy</a></span><span class="op">(</span>permissions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/options.html">options</a></span><span class="op">(</span>val.meter.policy <span class="op">=</span> <span class="va">permissive_policy</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/metrics.html">metrics</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">downloads_total</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="direct-calculation">Direct Calculation<a class="anchor" aria-label="anchor" href="#direct-calculation"></a>
</h3>
<p>Assessments, metrics and scores! Oh, my! These terms were used
inconsistently throughout <code>riskmetric</code> in ways that made the
package both hard to communicate about and confusing to use. We’ve
already mentioned that we’re doing away with opinionated scores. You
might be surprised to learn that despite all the talk of metrics, we’re
also doing away with assessments and metrics!</p>
<p>Now, there is only package <code>"data"</code> - a catch-all for any
piece of information derived about a package. We still refer to some
data as “metrics”, but in practical terms these are just a subset of
data with a couple additional constraints - metrics are always simple
(<code>atomic</code>) data types and they get a little flag that helps
us label data as useful for decision-making, but that is the extent of
the difference.</p>
<p>Fundamentally, the workflow has been reduced to a single step: a
package object derives data.</p>
</div>
<div class="section level3">
<h3 id="extensible">Extensible<a class="anchor" aria-label="anchor" href="#extensible"></a>
</h3>
<p>In <code>riskmetric</code>, there’s a noticeable lack of a
vulnerability scanning metric. Metrics which incur new dependencies were
always a challenge, forcing developers to decide between package
footprint and features.</p>
<p>In <code>val.meter</code> we’ve learned from this challenge to build
in metric-specific suggested dependencies and to make it easier to
register metrics from other packages.</p>
</div>
<div class="section level3">
<h3 id="metric-metadata">Metric Metadata<a class="anchor" aria-label="anchor" href="#metric-metadata"></a>
</h3>
<p>In <code>riskmetric</code>, discovering metrics was not as easy as it
should have been. Metrics were documented, but the exact details of
calculation sometimes required a deep dive into the package.</p>
<p>We’re aiming to make metrics far more discoverable. Every piece of
package data now carries additional metadata - tagged characteristics,
required permissions, a richly formatted description and short-form
title. Having this information tied to each metric will make it easier
to report and communicate consistently across R Validation Hub
products.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Doug Kelkhoff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
